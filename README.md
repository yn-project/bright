| 模块       | 二级模块           | 功能                                    | 状态     |
| :--------- | :----------------- | :-------------------------------------- | :------- |
| 智能合约   | 链上合约           | 内置维护密码                            | 待定     |
|            |                    | Ownerable合约初始化功能                 | 完成     |
|            |                    | Ownerable合约验证器                     | 完成     |
|            |                    | Ownerable合约设置Root帐号               | 完成     |
|            |                    | Admin合约初始化功能                     | 完成     |
|            |                    | Admin合约增加管理员                     | 完成     |
|            |                    | Admin合约设置管理员是否可用             | 完成     |
|            |                    | Admin合约删除管理员                     | 完成     |
|            |                    | Admin合约管理员验证器                   | 完成     |
|            |                    | DataFin合约初始化功能                   | 完成     |
|            |                    | DataFin合约增加ID对主题                 | 完成     |
|            |                    | DataFin合约增加匿名主题                 | 完成     |
|            |                    | DataFin合约ID对主题数据指纹提交批量功能 | 完成     |
|            |                    | DataFin合约匿名主题数据指纹提交批量功能 | 完成     |
|            |                    | DataFin合约验证ID对数据指纹             | 完成     |
|            |                    | DataFin合约验证匿名数据指纹             | 完成     |
|            |                    | DataFin合约标准验证器                   | 完成     |
|            | 合约部署前端       | 合约代码展示页面                        | 完成     |
|            |                    | 合约代码编译                            | 完成     |
|            |                    | 合约代码ABI接口查看                     | 完成     |
|            |                    | 合约代码API接口查看                     | 完成     |
|            |                    | 合约代码部署                            | 完成     |
|            |                    | 合约代码管理                            | 完成     |
|            | 合约部署后端       | 合约代码展示接口                        | 完成     |
|            |                    | 合约代码编译接口                        | 完成     |
|            |                    | 合约代码ABI生成接口                     | 完成     |
|            |                    | 合约代码API生成接口                     | 完成     |
|            |                    | 合约代码部署签名功能                    | 完成     |
|            |                    | 合约代码部署功能                        | 完成     |
|            |                    | 合约地址增删改查接口                    | 完成     |
| 数字指纹   | 指纹主题管理前端   | 数据指纹主题展示功能                    | 完成     |
|            |                    | 数据指纹主题增加功能                    | 完成     |
|            |                    | 数据指纹主题删除功能                    | 待定     |
|            |                    | 数据指纹主题信息录入功能                | 完成     |
|            |                    | 数据指纹主题属性录入功能                | 完成     |
|            |                    | 数据指纹主题验证状态展示功能            | 完成     |
|            | 指纹主题管理后端   | 数据指纹主题List接口                    | 完成     |
|            |                    | 链上拉取数据指纹主题功能                | 完成     |
|            |                    | 数据指纹主题增加接口                    | 完成     |
|            |                    | 数据指纹主题信息录入接口                | 完成     |
|            |                    | 数据指纹主题属性录入接口                | 完成     |
|            |                    | 合约增加数据指纹主题交易签名功能        | 完成     |
|            |                    | 合约增加数据指纹主题交易上链功能        | 完成     |
|            |                    | 合约增加数据指纹主题交易状态检测功能    | 完成     |
|            | 主题字段管理前端   | 主题数据来源List展示                    |          |
|            |                    | 增加主题数据来源基础信息功能            |          |
|            |                    | 增加数据包类主题数据来源功能            | 完成     |
|            |                    | 增加Pulsar消息中间件来源功能            | 完成     |
|            | 主题字段管理后端   | 主题数据来源List展示接口                | 完成     |
|            |                    | 增加主题数据来源基础信息接口            | 完成     |
|            |                    | 增加数据包类主题数据来源接口            | 完成     |
|            |                    | 增加Pulsar消息中间件来源接口            | 完成     |
|            | 指纹生成后端       | 提供直接指纹生成接口                    | 完成     |
|            |                    | 监听数据包来源指纹生成任务功能          | 完成     |
|            |                    | 监听Pulsar数据来源指纹生成任务功能      | 完成     |
|            |                    | 解析数据包数据记录功能                  | 完成     |
|            |                    | 解析Pulsar消息功能                      | 完成     |
|            |                    | 数据格式整理功能                        | 完成     |
|            |                    | 统一数据格式生成指纹功能                | 完成     |
|            |                    | 数据记录清除功能                        | 完成     |
|            |                    | 数据指纹生产者功能                      | 完成     |
|            |                    | 数据指纹入Pulsar队列功能                | 完成     |
|            | 指纹上链后端       | 监听Pulsar指纹上链任务功能              | 完成     |
|            |                    | 数据指纹上链数量自动调整功能            | 完成     |
|            |                    | 数据指纹上链频次自动调整功能            | 完成     |
|            |                    | 批量指纹上链交易签名功能                | 完成     |
|            |                    | 数据指纹批量上链功能                    | 完成     |
|            |                    | 数据指纹批量上链交易状态确认功能        | 完成     |
|            | 数据指纹验证       | 用户数据格式处理功能                    | 完成     |
|            |                    | 用户数据指纹提取功能                    | 完成     |
|            |                    | 数据指纹对比功能                        | 完成     |
|            |                    | 数据指纹验证接口                        | 完成     |
| 链账户     | 链账户前端         | 账户列表展示                            | 完成     |
|            |                    | 生成新链上账户功能                      | 完成     |
|            |                    | 设置账户是否可用功能                    | 完成     |
|            |                    | 点击查看私钥功能                        | 完成     |
|            |                    | 链上账户录入功能                        | 完成     |
|            |                    | 账户验证合约管理员功能                  | 完成     |
|            |                    | 设置账户为合约管理员功能                | 改为自动 |
|            |                    | 删除账户为合约管理员功能                | 完成     |
|            |                    | 启用账户为合约管理员功能                | 改为自动 |
|            | 链账户后端         | 账户列表展示接口                        | 完成     |
|            |                    | 真随机数生成功能                        | 完成     |
|            |                    | ED25519生成公私钥功能                   | 完成     |
|            |                    | 私钥混淆存储功能                        | 完成     |
|            |                    | 已有私钥生成对应公钥功能                | 完成     |
|            |                    | 设置账户是否可用接口                    | 完成     |
|            |                    | 恢复被混淆私钥功能                      | 完成     |
|            |                    | 私钥查看接口                            | 完成     |
|            |                    | 链上账户录入接口                        | 完成     |
|            |                    | 账户验证合约管理员交易生成功能          | 完成     |
|            |                    | 账户验证合约管理员交易签名功能          | 完成     |
|            |                    | 账户验证合约管理员链上查询功能          | 完成     |
|            |                    | 设置账户为合约管理员接口                | 完成     |
|            |                    | 设置账户为合约管理员交易生成            | 完成     |
|            |                    | 设置账户为合约管理员链上查询功能        | 完成     |
|            |                    | 删除账户为合约管理员接口                | 完成     |
|            |                    | 删除账户为合约管理员交易生成            | 完成     |
|            |                    | 删除账户为合约管理员链上查询功能        | 完成     |
|            |                    | 启用账户为合约管理员接口                | 完成     |
|            |                    | 启用账户为合约管理员交易生成            | 完成     |
|            |                    | 启用账户为合约管理员链上查询功能        | 完成     |
| 链节点     | 节点管理前端       | 区块链服务节点展示界面                  | 完成     |
|            |                    | 区块链服务节点录入功能                  | 完成     |
|            |                    | 区块链服务节点更新功能                  | 完成     |
|            |                    | 区块链服务节点删除功能                  | 完成     |
|            |                    | 区块链状态信息展示                      |          |
|            | 节点管理后端       | 区块链服务节点List接口                  | 完成     |
|            |                    | 区块链服务节点录入接口                  | 完成     |
|            |                    | 自动探测节点信息功能                    | 完成     |
|            |                    | 区块链服务节点更新接口                  | 完成     |
|            |                    | 实时检测节点状态功能                    | 完成     |
|            |                    | 自动上报节点状态功能                    | 完成     |
|            |                    | 区块链服务节点删除接口                  | 完成     |
|            |                    | 区块链状态信息获取功能                  | 完成     |
|            |                    | 区块链状态信息展示接口                  | 完成     |
| 第三方校验 | 校验二维码生成前端 | 二维码域名及端口配置功能                | 完成     |
|            |                    | 二维码接口生成方式配置功能              | 完成     |
|            |                    | 二维码生成功能                          | 完成     |
|            | 校验二维码生成后端 | 二维码域名及端口配置接口                | 完成     |
|            |                    | 二维码接口生成方式配置接口              | 完成     |
|            |                    | 二维码生成接口                          | 完成     |
|            |                    | 解析用户请求数据功能                    | 完成     |
|            |                    | 获取第三方辅助数据功能                  | 完成     |
|            |                    | 解析请求带入数据功能                    | 完成     |
|            |                    | 数据校验交易生成功能                    | 完成     |
|            |                    | 数据统一结构功能                        | 完成     |
|            |                    | 二维码数据指纹生成功能                  | 完成     |
|            |                    | 调用链上合约功能                        | 完成     |
|            |                    | 生成校验结果功能                        | 完成     |
|            |                    | 第三方数据指纹校验接口                  | 完成     |
| 用户管理   | 用户管理前端       | 用户登录页面                            |          |
|            |                    | 前端验证登录功能                        |          |
|            |                    | 用户列表页面                            |          |
|            |                    | 用户增加功能                            |          |
|            |                    | 用户更新功能                            |          |
|            |                    | 用户删除功能                            |          |
|            | 用户管理前端       | 用户登录接口                            |          |
|            |                    | 前端验证登录接口                        |          |
|            |                    | 用户列表接口                            |          |
|            |                    | 用户增加接口                            |          |
|            |                    | 用户更新接口                            |          |
|            |                    | 用户删除接口                            |          |

"系统采用最新最流行的微服务架构，故障处理灵活，已于维护和部署；

采用云原生架构部署系统应用，保证整个系统的高可用特性，其中使用MySql、Redis、Pulsar等开源中间件，保证系统安全同时提高系统性能保证稳定、可扩展、易于搭建等特性；

使用Web可视化的管理整个系统，易于管理员使用和维护；"





工具：

地址转换（ant-chain addr to address）


docker run --rm -dit --name mysql-dev -p 3306:3306 -e MYSQL_ROOT_PASSWORD=123456 -e MYSQL_ROOT_HOST=% mysql:5.6
mycli -uroot -hlocalhost
grant all privileges on *.* to 'root'@'%' identified by '123456' with grant option;
flush privileges;

 docker run -itd --name redis-test -p 6379:6379 redis

harbor 搭建
https://blog.csdn.net/qing040513/article/details/115750334
https://blog.csdn.net/IOT_AI/article/details/131839679

使用nerdctl替代docker命令以支持将image添加到containerd的命名空间下
https://www.qikqiak.com/k8strain2/containerd/nerdctl/ 安装
使用nertctl -n k8s.io  可看到containerd下的镜像

使用frp实现内网穿透，可访问内网机器

```Shell
# build 和 打docker
export AIMPORT=endpint
make build
make build-docker

AIMPORT=endpoint make build
AIMPORT=endpoint make build-docker
```

```Shell
# development box 开发相关
# 密码一般存在/etc/profile 中
cat /etc/profile
source /etc/profile

# 连接数据库一般使用mycli
apt install mycli -y
mycli -uroot -hmysql
```

# 蚂蚁链平台侧设置

代扣燃料研究（不支持）

研究如何交割企业版本

# 数据对接

是否直接接受已经提出指纹的数据？思考数据对接细节
失败数据如何处理（上链失败、解析json格式失败的数据）

# 添加链上账户

在区块链平台创建账户后,需要到蚂蚁联盟公链控制台将公钥填入.

# 添加主题

选择ID类型的主题时，可改属性一旦定了之后就无法修改可改属性

# 外部API调用

明确语意的错误提醒

# json中的Bytes

golang转成json时[]byte类型会用base64编码转换成string


gEb88EFa4x

## 怎么构建traefik镜像
如果存在docker和containerd双平台的情况，需要将镜像从docker中导出再导入到nerdctl（containerd）中
```Shell
cd tools/traefik-ingress
bash build.sh
\docker save $traefik_docker_image_id -o tmp_traefik.tar
docker load -i tmp_traefik.tar
docker images
docker tag $tmp_traefik_image_id bright/traefik-service:v2.5.3.6
```

## 部署Traefik
部署traefik时需要在暴露服务的node上打标签才能生效
```Shell
kubectl label nodes node_name key=val
```

## 暴露service

```yaml
---
apiVersion: v1
kind: Service
metadata:
  name: traefik
  namespace: kube-system
spec:
  type: NodePort
  ports:
    - port: 80
      targetPort: 80
      nodePort: 31080
      protocol: TCP
  selector:
    app: traefik
```

## 手动部署工程
```Shell
kubectl apply -k account/cmd/account/k8s/
kubectl apply -k contract/cmd/contract/
kubectl apply -k contract/cmd/contract/k8s/
kubectl apply -k datafin/cmd/datafin/k8s/
kubectl apply -k endpoint/cmd/endpoint/k8s/
kubectl apply -k user/cmd/user/k8s/
```